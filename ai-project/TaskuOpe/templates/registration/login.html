{% load static %}
<!DOCTYPE html>
<html lang="fi" data-theme="system">
<head>
    <meta charset="UTF-8">
    <title>Kirjaudu sisään</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Link to our main stylesheet to get all the variables and base styles -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <!-- The anti-flash script is important here too, for users with a saved dark theme preference -->
    <script>
        (function() {
            try {
                var theme = localStorage.getItem('theme');
                if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            } catch (e) { /* Fails gracefully */ }
        })();
    </script>
</head>
<body class="login-page-body">

    <div class="login-container">
        <!-- App Title -->
        <h2 class="login-title">TaskuOpe</h2>

        <!-- The login form is now inside our standard card component -->
        <article class="card">
            <h3 style="text-align: center; margin-bottom: 1.5rem;">Kirjaudu sisään</h3>

            <!-- KEPT: Messages framework include -->
            {% include "partials/messages.html" %}

            <!-- KEPT: Form error logic, now styled with our .form-errors class -->
            {% if form.errors %}
                <div class="form-errors">
                    {% for error in form.non_field_errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}

            <form method="post" action="{% url 'kirjaudu' %}" class="login-form">
                {% csrf_token %}

                <div class="form-group">
                    <label for="{{ form.username.id_for_label }}">Käyttäjätunnus</label>
                    {{ form.username }}
                </div>

                <div class="form-group">
                    <label for="{{ form.password.id_for_label }}">Salasana</label>
                    {{ form.password }}
                </div>

                <!-- KEPT: The hidden 'next' field for redirects -->
                {% if next %}
                    <input type="hidden" name="next" value="{{ next }}">
                {% endif %}

                <button type="submit" class="btn primary">Kirjaudu</button>
            </form>
        </article>
    </div>

</body>
</html>